"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const Database_1 = __importDefault(global[Symbol.for('ioc.use')]("Adonis/Lucid/Database"));
const PartidoModelo_1 = __importDefault(global[Symbol.for('ioc.use')]("App/Models/PartidoModelo"));
const Partido_1 = __importDefault(global[Symbol.for('ioc.use')]("App/Models/Partido"));
const mongoose_1 = __importDefault(require("mongoose"));
class MongosController {
    async guardarMongo({ request, response }) {
        await mongoose_1.default.connect('mongodb+srv://alannunez:celta3011@cluster0.4xeaf.mongodb.net/barco?retryWrites=true&w=majority');
        const clave_sala = request.input('Clave');
        const id_jugador = request.input('jugador');
        const monitor = request.input('monitor');
        const posicion = request.input('posicion');
        const main = request.input('main');
        console.log(clave_sala);
        const crear = new PartidoModelo_1.default.PartidaModelo({ "clave_sala": clave_sala, "jugadores": [{ id_jugador: id_jugador, monitor: monitor }], "main": main, "posicion": posicion });
        crear.save();
        return response.json(crear);
    }
    async insertar({ request, response }) {
        try {
            const Partidos = new Partido_1.default();
            const local = request.input('local');
            const visitante = request.input('visitante');
            const Estadio = request.input('Estadio');
            Partidos.local = local;
            Partidos.visitante = visitante;
            Partidos.Estadio = Estadio;
            await Partidos.save();
            return response.status(200);
        }
        catch {
            return response.status(500);
        }
    }
    async modificarMonitor({ request, response }) {
        try {
            await mongoose_1.default.connect('mongodb+srv://alannunez:celta3011@cluster0.4xeaf.mongodb.net/barco?retryWrites=true&w=majority');
            const clave_sala = request.input('clave_sala');
            const monitor = request.input('monitor');
            const newmonitor = request.input('newmoni');
            response = await PartidoModelo_1.default.PartidaModelo.updateOne({ clave_sala: clave_sala, "jugadores.monitor": monitor }, { $set: { "jugadores.$.monitor": newmonitor } });
            return response;
        }
        catch {
            return response.badRequest('Hubo un error');
        }
    }
    async modificarPos({ request, response }) {
        try {
            await mongoose_1.default.connect('mongodb+srv://alannunez:celta3011@cluster0.4xeaf.mongodb.net/barco?retryWrites=true&w=majority');
            const clave_sala = request.input('clave_sala');
            const posicion = request.input('posicion');
            const monitor = request.input('main');
            console.log(clave_sala);
            response = await PartidoModelo_1.default.PartidaModelo.updateOne({ clave_sala: clave_sala }, { $set: { "posicion": posicion, "main": monitor } });
            return response;
        }
        catch {
            return response.badRequest('Hubo un error');
        }
    }
    async getPartida({ params, response }) {
        try {
            await mongoose_1.default.connect('mongodb+srv://alannunez:celta3011@cluster0.4xeaf.mongodb.net/barco?retryWrites=true&w=majority');
            console.log(params.id);
            response = await PartidoModelo_1.default.PartidaModelo.find({ clave_sala: params.id });
            return response;
        }
        catch {
            return response.badRequest('Hubo un error');
        }
    }
    async agregarJugador({ request, response }) {
        try {
            await mongoose_1.default.connect('mongodb+srv://alannunez:celta3011@cluster0.4xeaf.mongodb.net/barco?retryWrites=true&w=majority');
            const clave_sala = request.input('clave_sala');
            const monitor = request.input('monitor');
            const jugador = request.input('jugador');
            console.log(clave_sala);
            response = await PartidoModelo_1.default.PartidaModelo.updateOne({ clave_sala: clave_sala }, { $push: { "jugadores": { id_jugador: jugador, monitor: monitor } } });
            return response;
        }
        catch {
            return response.badRequest('Hubo un error');
        }
    }
    async verPartido() {
        const partido = Database_1.default.query()
            .select('p.id as id', 'local.Nombre_Equipo as Local', 'visitante.Nombre_Equipo as Visitante', 'estadio.Nombre_Estadio as Estadio')
            .from('partidos as p')
            .join('equipos as local', 'p.local', '=', 'local.id')
            .join('equipos as visitante', 'p.visitante', '=', 'visitante.id')
            .join('estadios as estadio', 'p.Estadio', '=', 'estadio.id');
        return partido;
    }
    async verPartidas({ response }) {
        await mongoose_1.default.connect('mongodb+srv://alannunez:celta3011@cluster0.4xeaf.mongodb.net/barco?retryWrites=true&w=majority');
        response = await PartidoModelo_1.default.PartidaModelo.find();
        return response;
    }
    async delete({ auth, response, params }) {
        try {
            await auth.use('api').authenticate();
            const Equipos = await Partido_1.default.findOrFail(params.id);
            await Equipos.delete();
        }
        catch {
            return response.badRequest('ERROR');
        }
    }
}
exports.default = MongosController;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTW9uZ29zQ29udHJvbGxlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIk1vbmdvc0NvbnRyb2xsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDQSwyRkFBaUQ7QUFDakQsbUdBQW9EO0FBQ3BELHVGQUF3QztBQUN4Qyx3REFBK0I7QUFDL0IsTUFBcUIsZ0JBQWdCO0lBRTFCLEtBQUssQ0FBQyxZQUFZLENBQUMsRUFBQyxPQUFPLEVBQUMsUUFBUSxFQUFDO1FBRXhDLE1BQU0sa0JBQVEsQ0FBQyxPQUFPLENBQUMsZ0dBQWdHLENBQUMsQ0FBQTtRQUN4SCxNQUFNLFVBQVUsR0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFBO1FBQ3ZDLE1BQU0sVUFBVSxHQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUE7UUFDekMsTUFBTSxPQUFPLEdBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQTtRQUN0QyxNQUFNLFFBQVEsR0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBQ3hDLE1BQU0sSUFBSSxHQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUE7UUFDaEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQTtRQUN2QixNQUFNLEtBQUssR0FBQyxJQUFJLHVCQUFhLENBQUMsYUFBYSxDQUFDLEVBQUMsWUFBWSxFQUFDLFVBQVUsRUFBQyxXQUFXLEVBQUMsQ0FBQyxFQUFDLFVBQVUsRUFBQyxVQUFVLEVBQUUsT0FBTyxFQUFDLE9BQU8sRUFBQyxDQUFDLEVBQUMsTUFBTSxFQUFDLElBQUksRUFBRSxVQUFVLEVBQUMsUUFBUSxFQUFDLENBQUMsQ0FBQTtRQUM5SixLQUFLLENBQUMsSUFBSSxFQUFFLENBQUE7UUFDWixPQUFPLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUE7SUFDL0IsQ0FBQztJQUNNLEtBQUss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QUFtQyxDQUFDO2FBQzlILElBQUksQ0FBQyxlQUFlLENBQUM7YUFDckIsSUFBSSxDQUFDLGtCQUFrQixFQUFDLFNBQVMsRUFBQyxHQUFHLEVBQUMsVUFBVSxDQUFDO2FBQ2pELElBQUksQ0FBQyxzQkFBc0IsRUFBQyxhQUFhLEVBQUMsR0FBRyxFQUFDLGNBQWMsQ0FBQzthQUM3RCxJQUFJLENBQUMscUJBQXFCLEVBQUMsV0FBVyxFQUFDLEdBQUcsRUFBQyxZQUFZLENBQUMsQ0FBQTtRQUN6RCxPQUFPLE9BQU8sQ0FBQTtJQUNsQixDQUFDO0lBQ00sS0FBSyxDQUFDLFdBQVcsQ0FBQyxFQUFDLFFBQVEsRUFBQztRQUVqQyxNQUFNLGtCQUFRLENBQUMsT0FBTyxDQUFDLGdHQUFnRyxDQUFDLENBQUE7UUFDdEgsUUFBUSxHQUFDLE1BQU0sdUJBQWEsQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFLENBQUE7UUFDakQsT0FBTyxRQUFRLENBQUE7SUFDbkIsQ0FBQztJQUNNLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBQyxJQUFJLEVBQUMsUUFBUSxFQUFDLE1BQU0sRUFBQztRQUV0QyxJQUNBO1lBQ0ksTUFBTSxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLFlBQVksRUFBRSxDQUFBO1lBQ3BDLE1BQU0sT0FBTyxHQUFDLE1BQU0saUJBQU8sQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFBO1lBQ2pELE1BQU0sT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFBO1NBRXpCO1FBQUEsTUFDRDtZQUNJLE9BQU8sUUFBUSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQTtTQUN0QztJQUNMLENBQUM7Q0FFSjtBQWpJRCxtQ0FpSUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgdHlwZSB7IEh0dHBDb250ZXh0Q29udHJhY3QgfSBmcm9tICdAaW9jOkFkb25pcy9Db3JlL0h0dHBDb250ZXh0J1xuaW1wb3J0IERhdGFiYXNlIGZyb20gXCJAaW9jOkFkb25pcy9MdWNpZC9EYXRhYmFzZVwiXG5pbXBvcnQgUGFydGlkb01vZGVsbyBmcm9tIFwiQXBwL01vZGVscy9QYXJ0aWRvTW9kZWxvXCJcbmltcG9ydCBQYXJ0aWRvIGZyb20gXCJBcHAvTW9kZWxzL1BhcnRpZG9cIlxuaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb25nb3NDb250cm9sbGVyXG57XG4gICAgcHVibGljIGFzeW5jIGd1YXJkYXJNb25nbyh7cmVxdWVzdCxyZXNwb25zZX0pXG4gICAge1xuICAgICAgICBhd2FpdCBtb25nb29zZS5jb25uZWN0KCdtb25nb2RiK3NydjovL2FsYW5udW5lejpjZWx0YTMwMTFAY2x1c3RlcjAuNHhlYWYubW9uZ29kYi5uZXQvYmFyY28/cmV0cnlXcml0ZXM9dHJ1ZSZ3PW1ham9yaXR5JylcbiAgICAgICAgY29uc3QgY2xhdmVfc2FsYT1yZXF1ZXN0LmlucHV0KCdDbGF2ZScpXG4gICAgICAgIGNvbnN0IGlkX2p1Z2Fkb3I9cmVxdWVzdC5pbnB1dCgnanVnYWRvcicpXG4gICAgICAgIGNvbnN0IG1vbml0b3I9cmVxdWVzdC5pbnB1dCgnbW9uaXRvcicpXG4gICAgICAgIGNvbnN0IHBvc2ljaW9uPXJlcXVlc3QuaW5wdXQoJ3Bvc2ljaW9uJylcbiAgICAgICAgY29uc3QgbWFpbj1yZXF1ZXN0LmlucHV0KCdtYWluJylcbiAgICAgICAgY29uc29sZS5sb2coY2xhdmVfc2FsYSlcbiAgICAgICAgY29uc3QgY3JlYXI9bmV3IFBhcnRpZG9Nb2RlbG8uUGFydGlkYU1vZGVsbyh7XCJjbGF2ZV9zYWxhXCI6Y2xhdmVfc2FsYSxcImp1Z2Fkb3Jlc1wiOlt7aWRfanVnYWRvcjppZF9qdWdhZG9yLCBtb25pdG9yOm1vbml0b3J9XSxcIm1haW5cIjptYWluLCBcInBvc2ljaW9uXCI6cG9zaWNpb259KVxuICAgICAgICBjcmVhci5zYXZlKClcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oY3JlYXIpXG4gICAgfVxuICAgIHB1YmxpYyBhc3luYyBpbnNlcnRhcih7cmVxdWVzdCxyZXNwb25zZX0pXG4gICAge1xuICAgICAgICB0cnlcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgUGFydGlkb3M9bmV3IFBhcnRpZG8oKVxuICAgICAgICAgICAgY29uc3QgbG9jYWw9cmVxdWVzdC5pbnB1dCgnbG9jYWwnKVxuICAgICAgICAgICAgY29uc3QgdmlzaXRhbnRlPXJlcXVlc3QuaW5wdXQoJ3Zpc2l0YW50ZScpXG4gICAgICAgICAgICBjb25zdCBFc3RhZGlvPXJlcXVlc3QuaW5wdXQoJ0VzdGFkaW8nKVxuICAgICAgICAgICAgUGFydGlkb3MubG9jYWw9bG9jYWxcbiAgICAgICAgICAgIFBhcnRpZG9zLnZpc2l0YW50ZT12aXNpdGFudGVcbiAgICAgICAgICAgIFBhcnRpZG9zLkVzdGFkaW89RXN0YWRpb1xuICAgICAgICAgICAgYXdhaXQgUGFydGlkb3Muc2F2ZSgpXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzKDIwMClcbiAgICAgICAgfVxuICAgICAgICBjYXRjaFxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzKDUwMClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBtb2RpZmljYXJNb25pdG9yKHtyZXF1ZXN0LHJlc3BvbnNlfSlcbiAgICB7XG4gICAgICAgIHRyeVxuICAgICAgICB7XG4gICAgICAgICAgYXdhaXQgbW9uZ29vc2UuY29ubmVjdCgnbW9uZ29kYitzcnY6Ly9hbGFubnVuZXo6Y2VsdGEzMDExQGNsdXN0ZXIwLjR4ZWFmLm1vbmdvZGIubmV0L2JhcmNvP3JldHJ5V3JpdGVzPXRydWUmdz1tYWpvcml0eScpXG4gICAgICAgICAgY29uc3QgY2xhdmVfc2FsYT1yZXF1ZXN0LmlucHV0KCdjbGF2ZV9zYWxhJylcbiAgICAgICAgICBjb25zdCBtb25pdG9yPXJlcXVlc3QuaW5wdXQoJ21vbml0b3InKVxuICAgICAgICAgIGNvbnN0IG5ld21vbml0b3I9cmVxdWVzdC5pbnB1dCgnbmV3bW9uaScpXG4gICAgICAgICAgcmVzcG9uc2U9IGF3YWl0IFBhcnRpZG9Nb2RlbG8uUGFydGlkYU1vZGVsby51cGRhdGVPbmUoe2NsYXZlX3NhbGE6Y2xhdmVfc2FsYSwgXCJqdWdhZG9yZXMubW9uaXRvclwiOm1vbml0b3J9LHskc2V0OntcImp1Z2Fkb3Jlcy4kLm1vbml0b3JcIjpuZXdtb25pdG9yfX0pXG4gICAgICAgICAgcmV0dXJuIHJlc3BvbnNlXG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2hcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuICByZXNwb25zZS5iYWRSZXF1ZXN0KCdIdWJvIHVuIGVycm9yJylcbiAgICAgICAgfVxuICAgIH1cbiAgICBwdWJsaWMgYXN5bmMgbW9kaWZpY2FyUG9zKHtyZXF1ZXN0LHJlc3BvbnNlfSlcbiAgICB7XG4gICAgICAgIHRyeVxuICAgICAgICB7XG4gICAgICAgICAgYXdhaXQgbW9uZ29vc2UuY29ubmVjdCgnbW9uZ29kYitzcnY6Ly9hbGFubnVuZXo6Y2VsdGEzMDExQGNsdXN0ZXIwLjR4ZWFmLm1vbmdvZGIubmV0L2JhcmNvP3JldHJ5V3JpdGVzPXRydWUmdz1tYWpvcml0eScpXG4gICAgICAgICAgY29uc3QgY2xhdmVfc2FsYT1yZXF1ZXN0LmlucHV0KCdjbGF2ZV9zYWxhJylcbiAgICAgICAgICBjb25zdCBwb3NpY2lvbj1yZXF1ZXN0LmlucHV0KCdwb3NpY2lvbicpXG4gICAgICAgICAgY29uc3QgbW9uaXRvcj1yZXF1ZXN0LmlucHV0KCdtYWluJylcbiAgICAgICAgICBjb25zb2xlLmxvZyhjbGF2ZV9zYWxhKVxuICAgICAgICAgIHJlc3BvbnNlPSBhd2FpdCBQYXJ0aWRvTW9kZWxvLlBhcnRpZGFNb2RlbG8udXBkYXRlT25lKHtjbGF2ZV9zYWxhOmNsYXZlX3NhbGF9LHskc2V0OntcInBvc2ljaW9uXCI6cG9zaWNpb24sIFwibWFpblwiOm1vbml0b3J9fSlcbiAgICAgICAgICByZXR1cm4gcmVzcG9uc2VcbiAgICAgICAgfVxuICAgICAgICBjYXRjaFxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gIHJlc3BvbnNlLmJhZFJlcXVlc3QoJ0h1Ym8gdW4gZXJyb3InKVxuICAgICAgICB9XG4gICAgfVxuICAgIHB1YmxpYyBhc3luYyBnZXRQYXJ0aWRhKHtwYXJhbXMscmVzcG9uc2V9KVxuICAgIHtcbiAgICAgICAgdHJ5XG4gICAgICAgIHtcbiAgICAgICAgICBhd2FpdCBtb25nb29zZS5jb25uZWN0KCdtb25nb2RiK3NydjovL2FsYW5udW5lejpjZWx0YTMwMTFAY2x1c3RlcjAuNHhlYWYubW9uZ29kYi5uZXQvYmFyY28/cmV0cnlXcml0ZXM9dHJ1ZSZ3PW1ham9yaXR5JylcbiAgICAgICAgICBjb25zb2xlLmxvZyhwYXJhbXMuaWQpXG4gICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBQYXJ0aWRvTW9kZWxvLlBhcnRpZGFNb2RlbG8uZmluZCh7Y2xhdmVfc2FsYTpwYXJhbXMuaWR9KVxuICAgICAgICAgIHJldHVybiByZXNwb25zZVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiAgcmVzcG9uc2UuYmFkUmVxdWVzdCgnSHVibyB1biBlcnJvcicpXG4gICAgICAgIH1cbiAgICB9XG4gICAgcHVibGljIGFzeW5jIGFncmVnYXJKdWdhZG9yKHtyZXF1ZXN0LHJlc3BvbnNlfSlcbiAgICB7XG4gICAgICAgIHRyeVxuICAgICAgICB7XG4gICAgICAgICAgYXdhaXQgbW9uZ29vc2UuY29ubmVjdCgnbW9uZ29kYitzcnY6Ly9hbGFubnVuZXo6Y2VsdGEzMDExQGNsdXN0ZXIwLjR4ZWFmLm1vbmdvZGIubmV0L2JhcmNvP3JldHJ5V3JpdGVzPXRydWUmdz1tYWpvcml0eScpXG4gICAgICAgICAgY29uc3QgY2xhdmVfc2FsYT1yZXF1ZXN0LmlucHV0KCdjbGF2ZV9zYWxhJylcbiAgICAgICAgICBjb25zdCBtb25pdG9yPXJlcXVlc3QuaW5wdXQoJ21vbml0b3InKVxuICAgICAgICAgIGNvbnN0IGp1Z2Fkb3I9IHJlcXVlc3QuaW5wdXQoJ2p1Z2Fkb3InKVxuICAgICAgICAgIGNvbnNvbGUubG9nKGNsYXZlX3NhbGEpXG4gICAgICAgICAgcmVzcG9uc2U9IGF3YWl0IFBhcnRpZG9Nb2RlbG8uUGFydGlkYU1vZGVsby51cGRhdGVPbmUoe2NsYXZlX3NhbGE6Y2xhdmVfc2FsYX0seyRwdXNoOntcImp1Z2Fkb3Jlc1wiOnsgaWRfanVnYWRvcjpqdWdhZG9yLCBtb25pdG9yOm1vbml0b3J9fX0pXG4gICAgICAgICAgcmV0dXJuIHJlc3BvbnNlXG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2hcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuICByZXNwb25zZS5iYWRSZXF1ZXN0KCdIdWJvIHVuIGVycm9yJylcbiAgICAgICAgfVxuICAgIH1cbiAgICBwdWJsaWMgYXN5bmMgdmVyUGFydGlkbygpXG4gICAge1xuICAgICAgICBjb25zdCBwYXJ0aWRvPURhdGFiYXNlLnF1ZXJ5KClcbiAgICAgICAgLnNlbGVjdCgncC5pZCBhcyBpZCcsJ2xvY2FsLk5vbWJyZV9FcXVpcG8gYXMgTG9jYWwnLCd2aXNpdGFudGUuTm9tYnJlX0VxdWlwbyBhcyBWaXNpdGFudGUnLCdlc3RhZGlvLk5vbWJyZV9Fc3RhZGlvIGFzIEVzdGFkaW8nKVxuICAgICAgICAuZnJvbSgncGFydGlkb3MgYXMgcCcpXG4gICAgICAgIC5qb2luKCdlcXVpcG9zIGFzIGxvY2FsJywncC5sb2NhbCcsJz0nLCdsb2NhbC5pZCcpXG4gICAgICAgIC5qb2luKCdlcXVpcG9zIGFzIHZpc2l0YW50ZScsJ3AudmlzaXRhbnRlJywnPScsJ3Zpc2l0YW50ZS5pZCcpXG4gICAgICAgIC5qb2luKCdlc3RhZGlvcyBhcyBlc3RhZGlvJywncC5Fc3RhZGlvJywnPScsJ2VzdGFkaW8uaWQnKVxuICAgICAgICByZXR1cm4gcGFydGlkb1xuICAgIH1cbiAgICBwdWJsaWMgYXN5bmMgdmVyUGFydGlkYXMoe3Jlc3BvbnNlfSlcbiAgICB7XG4gICAgICBhd2FpdCBtb25nb29zZS5jb25uZWN0KCdtb25nb2RiK3NydjovL2FsYW5udW5lejpjZWx0YTMwMTFAY2x1c3RlcjAuNHhlYWYubW9uZ29kYi5uZXQvYmFyY28/cmV0cnlXcml0ZXM9dHJ1ZSZ3PW1ham9yaXR5JylcbiAgICAgICAgcmVzcG9uc2U9YXdhaXQgUGFydGlkb01vZGVsby5QYXJ0aWRhTW9kZWxvLmZpbmQoKVxuICAgICAgICByZXR1cm4gcmVzcG9uc2VcbiAgICB9XG4gICAgcHVibGljIGFzeW5jIGRlbGV0ZSh7YXV0aCxyZXNwb25zZSxwYXJhbXN9KVxuICAgIHtcbiAgICAgICAgdHJ5XG4gICAgICAgIHtcbiAgICAgICAgICAgIGF3YWl0IGF1dGgudXNlKCdhcGknKS5hdXRoZW50aWNhdGUoKVxuICAgICAgICAgICAgY29uc3QgRXF1aXBvcz1hd2FpdCBQYXJ0aWRvLmZpbmRPckZhaWwocGFyYW1zLmlkKVxuICAgICAgICAgICAgYXdhaXQgRXF1aXBvcy5kZWxldGUoKVxuXG4gICAgICAgIH1jYXRjaFxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuYmFkUmVxdWVzdCgnRVJST1InKVxuICAgICAgICB9XG4gICAgfVxuXG59XG4iXX0=